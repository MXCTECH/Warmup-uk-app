<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Calendar Booking | Warm Up UK</title>
  <style>
    body {
      background-color: #111;
      color: #fff;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      text-align: center;
    }
    h1 {
      color: #f5c542;
      font-size: 26px;
    }
    form {
      background: #1a1a1a;
      border-radius: 10px;
      padding: 20px;
      max-width: 400px;
      margin: 20px auto;
      box-shadow: 0 0 10px #f5c54255;
    }
    label {
      display: block;
      text-align: left;
      margin-bottom: 5px;
      color: #f5c542;
      font-weight: bold;
    }
    input, select, textarea {
      width: 100%;
      padding: 8px;
      border: none;
      border-radius: 6px;
      margin-bottom: 15px;
      background: #2a2a2a;
      color: #fff;
      font-size: 15px;
    }
    button {
      width: 100%;
      background-color: #f5c542;
      color: #000;
      padding: 10px;
      border: none;
      border-radius: 6px;
      font-weight: bold;
      font-size: 16px;
    }
    button:hover {
      background-color: #ffd966;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <img src="WUUK.JPG" alt="Warm Up UK Logo" style="width:80px; margin-bottom:10px;">
  <h1>Calendar Booking</h1>

  <form id="bookingForm">
    <label>Name</label>
    <input type="text" id="name" placeholder="Client name" required>

    <label>Phone (WhatsApp)</label>
    <input type="tel" id="phone" placeholder="+447..." required>

    <label>Address</label>
    <input type="text" id="address" placeholder="Client address" required>

    <label>Date</label>
    <input type="date" id="date" required>

    <label>Time</label>
    <input type="time" id="time" required>

    <label>Service</label>
    <select id="service">
      <option value="Loft Insulation">Loft Insulation</option>
      <option value="Spray Foam Removal">Spray Foam Removal</option>
      <option value="Multifoil Insulation">Multifoil Insulation</option>
      <option value="Other">Other</option>
    </select>

    <label>Booking Agent</label>
    <input type="text" id="agent" placeholder="Booking agent name">

    <label>Confirmer</label>
    <input type="text" id="confirmer" placeholder="Confirmer name">

    <label>Sales Rep</label>
    <input type="text" id="salesrep" placeholder="Sales rep name">

    <label>Notes</label>
    <textarea id="notes" rows="3" placeholder="Add any notes..."></textarea>

    <button type="button" onclick="sendToWhatsApp()">Send to WhatsApp</button>
  </form>

  <script>
    function sendToWhatsApp() {
      const name = document.getElementById("name").value;
      const phone = document.getElementById("phone").value.replace(/\s/g, '');
      const address = document.getElementById("address").value;
      const date = document.getElementById("date").value;
      const time = document.getElementById("time").value;
      const service = document.getElementById("service").value;
      const agent = document.getElementById("agent").value;
      const confirmer = document.getElementById("confirmer").value;
      const salesrep = document.getElementById("salesrep").value;
      const notes = document.getElementById("notes").value;

      if (!phone || !name) {
        alert("Please enter client name and phone number.");
        return;
      }

      const message = `Warm Up UK Booking:%0A
Name: ${name}%0A
Address: ${address}%0A
Date: ${date}%0A
Time: ${time}%0A
Service: ${service}%0A
Booking Agent: ${agent}%0A
Confirmer: ${confirmer}%0A
Sales Rep: ${salesrep}%0A
Notes: ${notes}%0A
Open Contract: https://warmupuk.github.io/Warmup-uk-app/contract.html?client=${encodeURIComponent(name)}&phone=${encodeURIComponent(phone)}`;

      const url = `https://wa.me/${phone}?text=${message}`;
      window.open(url, '_blank');
    }
  </script>
</body>
</html>

<!-- WhatsApp Send Button -->
<div style="text-align:center; margin:24px 0 40px;">
  <button id="btn_send_whatsapp"
          style="background:linear-gradient(180deg,#ffc94d,#d7ac3a); color:#121212; 
                 font-weight:800; border:0; border-radius:12px; padding:12px 18px;
                 box-shadow:0 10px 22px rgba(255,201,77,.25); cursor:pointer;">
    Send Contract via WhatsApp
  </button>
</div>

<script>
  document.getElementById('btn_send_whatsapp').addEventListener('click', () => {
    const name   = document.getElementById('c_name')?.value || 'Client';
    const phone  = document.getElementById('c_phone1')?.value || '';
    const notes  = document.getElementById('notes')?.value  || '';
    const total  = document.getElementById('q_total')?.textContent || '';
    const svcRow = document.querySelector('#prod_table tbody tr:first-child .p_sel');
    const service = svcRow ? svcRow.options[svcRow.selectedIndex].text : (new URLSearchParams(location.search).get('service') || 'Service');

    const intl = formatUK(phone);
    if (!intl) { alert('No valid phone number found. Please enter the client phone in the form.'); return; }

    const msg = [
      `Warm Up UK â€“ Contract`,
      `Name: ${name}`,
      `Service: ${service}`,
      total ? `Total: ${total}` : null,
      notes ? `Notes: ${notes}` : null,
      `Thank you!`
    ].filter(Boolean).join('\n');

    const url = `https://wa.me/${intl}?text=${encodeURIComponent(msg)}`;
    window.open(url, '_blank');
  });
</script>
