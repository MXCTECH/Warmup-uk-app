<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Teams/Outlook Calendar â€“ Warm Up UK</title>
  <link rel="stylesheet" href="app.css" />
  <style>
    body { background:#0b0c0f; color:#f0c55a; font-family: -apple-system, Segoe UI, Roboto, Arial; }
    .wrap { max-width: 900px; margin: 24px auto; padding: 0 16px; }
    .card { background:#11141d; border:1px solid #232833; border-radius:12px; padding:14px; }
    .btn { display:inline-block; padding:12px 16px; border-radius:10px; font-weight:900; 
           background:linear-gradient(180deg,#f0c55a,#e0ae2c); color:#000; text-decoration:none; }
    .muted { color:#a1a8b6; }
    iframe { width:100%; height:70vh; border:0; border-radius:10px; background:#0b0c0f; }
    nav a { color:#f0c55a; text-decoration:none; font-weight:800; margin-right:8px; }
  </style>
</head>
<body>
  <div class="wrap">
    <nav>
      <a href="dashboard.html">Dashboard</a> Â·
      <a href="calendar.html">Calendar</a> Â·
      <a href="contract.html">Contract</a>
    </nav>

    <h1>ðŸ“… Teams / Outlook Calendar</h1>
    <p class="muted">If your organisation blocks embedding, youâ€™ll see a button to open the calendar directly.</p>

    <!-- 1) EMBED (replace the src below with your Outlook/Teams HTML share link) -->
    <div class="card" id="embedBox" style="display:none">
      <iframe id="calFrame"
        src="YOUR_OUTLOOK_HTML_SHARE_LINK_HERE"
        referrerpolicy="no-referrer-when-downgrade"
        loading="lazy"
        title="Teams/Outlook Calendar">
      </iframe>
    </div>

    <!-- 2) FALLBACK BUTTON -->
    <div class="card" id="fallbackBox" style="display:none">
      <p class="muted" style="margin:0 0 10px">Embedding is blocked on this device or domain.</p>
      <a id="fallbackBtn" class="btn" href="#" target="_blank" rel="noopener">Open in Outlook/Teams â†’</a>
    </div>
  </div>

  <script>
    // >>>> IMPORTANT: paste your Outlook/Teams "HTML link" here (from Outlook on the web â†’ Calendar â†’ Sharing & permissions)
    const OUTLOOK_HTML_LINK = "YOUR_OUTLOOK_HTML_SHARE_LINK_HERE";

    // Show iframe if we have a link; otherwise only show fallback button
    const embedBox = document.getElementById('embedBox');
    const fallbackBox = document.getElementById('fallbackBox');
    const fallbackBtn = document.getElementById('fallbackBtn');
    const calFrame = document.getElementById('calFrame');

    fallbackBtn.href = OUTLOOK_HTML_LINK || '#';

    // Try to use the iframe when we have a link
    if (OUTLOOK_HTML_LINK && OUTLOOK_HTML_LINK.startsWith('http')) {
      calFrame.src = OUTLOOK_HTML_LINK;
      embedBox.style.display = 'block';

      // If the iframe fails (common with Microsoft X-Frame-Options), show fallback
      const iframeTimeout = setTimeout(() => {
        embedBox.style.display = 'none';
        fallbackBox.style.display = 'block';
      }, 2500);

      calFrame.addEventListener('load', () => {
        clearTimeout(iframeTimeout);
        // Some orgs still show a blank iframe; offer the fallback button anyway:
        fallbackBox.style.display = 'block';
      });
    } else {
      // No link provided â†’ just show the fallback button
      fallbackBox.style.display = 'block';
    }
  </script>
</body>
</html>
