<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Warm Up UK Homes Limited – Contract</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.7/dist/signature_pad.umd.min.js"></script>

<style>
:root{
  --black:#0f1114;
  --gold:#d9b15a;
  --red:#b80000;
  --panel:#fff;
}

/* ---------- general layout ---------- */
body{margin:0;background:#0b0d10;font-family:Arial,Helvetica,sans-serif;}
.page{max-width:900px;margin:16px auto;background:var(--panel);border-radius:14px;overflow:hidden;box-shadow:0 12px 24px rgba(0,0,0,.35);}

/* ---------- header ---------- */
header{
  background:linear-gradient(180deg,#0f1114 0%,#0f1114 60%,rgba(15,17,20,0) 100%);
  color:var(--gold);
  text-align:center;
  padding:12px 10px 54px;
  letter-spacing:.08em;
  font-weight:600;
  text-transform:uppercase;
}
.logo-bar{text-align:center;margin-top:-46px}
.logo-img{height:200px;max-width:380px;object-fit:contain;filter:drop-shadow(0 3px 6px rgba(0,0,0,.5))}
.subheader{text-align:center;background:#fff;padding:8px;font-size:11.5px;border-bottom:1px solid #eee;}

/* ---------- form ---------- */
.inner{padding:14px 16px;}
.section-title{margin:16px 0 8px;font-weight:700;color:#0f1114;text-transform:uppercase;font-size:12px;}
.section-title::before{content:'';display:inline-block;width:4px;height:14px;background:var(--gold);margin-right:6px;border-radius:2px;}
.row{display:flex;flex-wrap:wrap;gap:10px}
.col{flex:1 1 180px;min-width:150px}
label{display:block;font-size:10.8px;margin-bottom:4px;color:#333;text-transform:uppercase}
input,select,textarea{width:100%;padding:6px 8px;border:1px solid #ccc;border-radius:6px;font-size:12.5px;background:#f5f6f7;}
input:focus,textarea:focus{border-color:var(--gold);outline:none;background:#fff;}
textarea{min-height:65px}

/* ---------- table ---------- */
table{width:100%;border-collapse:collapse;margin-top:4px;font-size:12px}
th,td{border:1px solid #eee;padding:5px}
th{background:#f9f9f9;text-transform:uppercase;font-size:10.3px;color:#444}
button{background:var(--black);color:#fff;border:none;border-radius:6px;padding:7px 12px;font-size:12px;cursor:pointer}
button.secondary{background:#eee;color:#333}
.btn-row{margin:10px 0;display:flex;gap:8px;flex-wrap:wrap}

/* ---------- totals ---------- */
.totals-terms-row{display:flex;flex-wrap:wrap;gap:12px;margin-top:8px}
.totals-box{flex:0 0 240px;border:1px solid #ddd;border-radius:8px;font-size:10.6px}
.totals-box div{display:flex;justify-content:space-between;padding:4px 6px}
.totals-box div:nth-child(odd){background:#faf7f1}
.totals-box .grand{background:var(--black);color:var(--gold);font-weight:700}
.terms-inline{flex:1 1 0;border:1px solid #ddd;padding:8px;border-radius:8px;font-size:10.2px;line-height:1.25}

/* ---------- waiver ---------- */
.waiver{margin-top:8px;border:1px solid rgba(184,0,0,0.35);background:rgba(184,0,0,0.05);padding:8px 9px;border-radius:9px;page-break-inside:avoid}
.waiver-title{color:var(--red);font-weight:700;text-transform:uppercase;font-size:11px;margin-bottom:4px}

/* ---------- signatures ---------- */
.signature-area{display:flex;flex-wrap:wrap;gap:10px;margin-top:10px}
.sig-box{flex:1 1 260px;display:flex;flex-direction:column;gap:4px;background:#f7f8fa;border:1px solid #eee;border-radius:8px;padding:6px}
.sig-pad{border:1px dashed #999;width:100%;height:110px;border-radius:7px;background:#fff;touch-action:none}
.sig-note{font-size:10px;color:#666}

/* ---------- footer ---------- */
footer{text-align:center;background:#0f1114;color:var(--gold);padding:8px;font-size:11px;text-transform:uppercase;font-weight:600}

/* ---------- mobile ---------- */
@media(max-width:700px){
  .page{border-radius:0;box-shadow:none;margin:0}
  .totals-terms-row{flex-direction:column}
  .totals-box,.terms-inline{width:100%;max-width:100%}
  .signature-area{flex-direction:column}
  button{flex:1}
}

/* ---------- PRINT ---------- */
@media print{
  body{background:#fff!important}
  .logo-bar{display:none!important;}      /* hide logo */
  header{padding:6px 4px 2px!important;}
  .subheader{font-size:9.5px;padding:3px!important;}
  .inner{padding:6px 8px!important;}
  .totals-box{font-size:9px}
  .terms-inline{font-size:9px;padding:5px}
  .waiver{font-size:9px;padding:4px 5px;max-height:85px;overflow:hidden;page-break-inside:avoid}
  .signature-area,.signature-area+textarea{page-break-before:always;}
  button{display:none!important}
}
</style>
</head>

<body>
<div class="page" id="contractPage">
  <header>WARM UP UK HOMES LIMITED</header>
  <div class="logo-bar"><img src="New logo .PNG" class="logo-img"></div>
  <div class="subheader">
    Fitzwilliam House, Middle Bank, Doncaster, England, DN4 5NG · Tel 07470 474 774 · Email danielle@warmuphomes.co.uk
  </div>

  <div class="inner">
    <!-- CLIENT -->
    <h2 class="section-title">Client details</h2>
    <div class="row">
      <div class="col"><label>Name</label><input id="clientName"></div>
      <div class="col"><label>Address</label><input id="clientAddress"></div>
      <div class="col"><label>Postcode</label><input id="clientPostcode"></div>
      <div class="col"><label>Phone</label><input id="clientPhone"></div>
    </div>
    <div class="row">
      <div class="col"><label>Email</label><input id="clientEmail"></div>
      <div class="col"><label>Survey Date</label><input type="date" id="surveyDate"></div>
      <div class="col"><label>Install Date</label><input type="date" id="installDate"></div>
    </div>

    <!-- PRODUCTS -->
    <h2 class="section-title">Products / works</h2>
    <table id="productsTable">
      <thead><tr><th>Product</th><th>Size m²</th><th>£/m²</th><th>Total £</th><th></th></tr></thead>
      <tbody id="productsBody">
        <tr>
          <td>
            <select class="productSelect">
              <option value="">--select--</option>
              <option>Spray Foam Removal</option>
              <option>New Loft Insulation Install</option>
              <option>Loft Top-Up (270 mm)</option>
              <option>Loft Clearance / Preparation</option>
              <option>Loft Boarding</option>
              <option>Multifoil / TLX Silver / YBS SuperQuilt</option>
              <option>Pitched Roof Insulation</option>
              <option>Cavity Wall Extraction</option>
              <option>VCL / Membrane / Vapour Barrier</option>
            </select>
          </td>
          <td><input type="number" class="sizeInput" min="0" step="0.1"></td>
          <td><input type="number" class="unitInput" min="0" step="0.01" value="0"></td>
          <td><input type="text" class="lineTotal" value="0.00" readonly></td>
          <td><button type="button" class="secondary delRow">X</button></td>
        </tr>
      </tbody>
    </table>
    <div class="btn-row"><button id="addProduct">+ Add Product</button></div>

    <!-- TOTALS + TERMS -->
    <div class="totals-terms-row">
      <div class="totals-box">
        <div><span>Sub Total</span><span id="subTotal">£0.00</span></div>
        <div><span>Discount</span><input type="number" id="discount" value="0"></div>
        <div><span>VAT 20%</span><span id="vatAmount">£0.00</span></div>
        <div><span>VAT On?</span><input type="checkbox" id="vatToggle" checked style="width:auto"></div>
        <div><span>Deposit</span><input type="number" id="deposit" value="0"></div>
        <div class="grand"><span>Total</span><span id="grandTotal">£0.00</span></div>
      </div>

      <div class="terms-inline">
        <strong>Terms & Conditions (summary)</strong>
        1. Deposit on order, balance on completion unless agreed in writing.<br>
        2. Materials remain Warm Up UK Homes Ltd property until paid in full.<br>
        3. Client to provide safe access on install date.<br>
        4. Hidden or extra clearance / spray foam may be chargeable.<br>
        5. Date changes inside 48 hrs can incur a lost-day fee.<br>
        6. Our install standards take priority.<br>
        7. Structural / damp / electrical issues out of scope unless listed.<br>
        8. Client confirms authority to order and agrees to pay on completion.
      </div>
    </div>

    <!-- WAIVER -->
    <div class="waiver" id="waiverBox">
      <div class="waiver-title">Customer Waiver / Variations</div>
      <p style="font-size:10px;margin:3px 0">
        I confirm the above works and authorise Warm Up UK Homes Ltd to proceed.
      </p>
      <p style="font-size:10px;margin:3px 0">
        Express installs: where I request works to start within the 14-day cancellation period, I accept the express start waiver below.
      </p>
      <textarea id="waiverNotes" placeholder="Initials / special agreement..."></textarea>
      <div class="btn-row"><button id="expressBtn" style="background:var(--red)">+ EXPRESS FIT WAIVER</button></div>
    </div>

    <!-- SIGNATURES -->
    <h2 class="section-title">Sign-off & Signatures</h2>
    <div class="signature-area">
      <div class="sig-box">
        <canvas class="sig-pad" id="sigCustomer"></canvas>
        <div class="sig-note">Customer signature</div>
        <input type="text" id="clientPrintedName" placeholder="Customer name (print)">
        <button type="button" class="secondary" onclick="clearPad('sigCustomer')">Clear</button>
      </div>
      <div class="sig-box">
        <canvas class="sig-pad" id="sigRep"></canvas>
        <div class="sig-note">Warm Up rep signature</div>
        <input type="text" id="repPrintedName" placeholder="Rep name (print)">
        <button type="button" class="secondary" onclick="clearPad('sigRep')">Clear</button>
      </div>
    </div>

    <h2 class="section-title">Notes</h2>
    <textarea id="notes" placeholder="Access, parking, hatch size, special instructions..."></textarea>

    <div class="btn-row">
      <button id="generatePdf">Generate PDF</button>
      <button id="clearForm" class="secondary">Clear</button>
    </div>
  </div>
  <footer>WARM UP UK HOMES LIMITED</footer>
</div>

<script>
/* ---------- calculations ---------- */
function createRow(){const tr=document.createElement('tr');tr.innerHTML=document.querySelector('#productsBody tr').innerHTML;return tr;}
const bodyEl=document.getElementById('productsBody');
document.getElementById('addProduct').onclick=()=>{bodyEl.appendChild(createRow());};
bodyEl.addEventListener('input',recalc);
bodyEl.addEventListener('click',e=>{if(e.target.classList.contains('delRow')&&bodyEl.rows.length>1){e.target.closest('tr').remove();recalc();}});
['discount','vatToggle','deposit'].forEach(id=>document.getElementById(id).addEventListener('input',recalc));
const subTotal=document.getElementById('subTotal'),vatAmount=document.getElementById('vatAmount'),grandTotal=document.getElementById('grandTotal'),discount=document.getElementById('discount'),vatToggle=document.getElementById('vatToggle'),deposit=document.getElementById('deposit');
function recalc(){let subtotal=0;bodyEl.querySelectorAll('tr').forEach(tr=>{const s=parseFloat(tr.querySelector('.sizeInput').value)||0;const r=parseFloat(tr.querySelector('.unitInput').value)||0;const line=s*r;tr.querySelector('.lineTotal').value=line.toFixed(2);subtotal+=line;});subTotal.textContent='£'+subtotal.toFixed(2);const d=parseFloat(discount.value)||0;let base=subtotal-d;if(base<0)base=0;const vat=vatToggle.checked?base*0.2:0;vatAmount.textContent='£'+vat.toFixed(2);const dep=parseFloat(deposit.value)||0;let total=base+vat-dep;if(total<0)total=0;grandTotal.textContent='£'+total.toFixed(2);}

/* ---------- signatures ---------- */
const sigPads={};
function initSigPad(id){const c=document.getElementById(id);const p=new SignaturePad(c,{backgroundColor:'#fff',penColor:'#000'});resize(c,p);sigPads[id]=p;}
function resize(c,p){const r=Math.max(window.devicePixelRatio||1,1),rect=c.getBoundingClientRect();c.width=rect.width*r;c.height=rect.height*r;const ctx=c.getContext("2d");ctx.setTransform(r,0,0,r,0,0);p.clear();}
function clearPad(id){if(sigPads[id])sigPads[id].clear();}
window.addEventListener('resize',()=>Object.keys(sigPads).forEach(i=>resize(document.getElementById(i),sigPads[i])));
initSigPad('sigCustomer');initSigPad('sigRep');

/* ---------- waiver toggle ---------- */
const expressBtn=document.getElementById('expressBtn');
expressBtn.onclick=()=>{const box=document.getElementById('waiverBox'),notes=document.getElementById('waiverNotes');
if(!box.classList.contains('express')){box.classList.add('express');box.querySelector('.waiver-title').textContent='EXPRESS FIT WAIVER – ACCEPTED';notes.value='I/we request Warm Up UK Homes Limited commence works immediately within the 14-day period and understand this may waive the right to cancel for work or materials already done.';notes.readOnly=true;expressBtn.textContent='✔ Express Fit Added';expressBtn.style.background='#444';}
else{box.classList.remove('express');box.querySelector('.wa
